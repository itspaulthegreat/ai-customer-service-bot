$item('#ratingsInputDesktop').onChange((event) => {
                    const newRating = parseInt(event.target.value);
                    console.log(`[ratingsInputDesktop.onChange] New rating ${newRating} for order ${itemData.displayOrderId}`);
                    submitRating({
                            userId: userId,
                            orderId: itemData.orderId,
                            productId: itemData.catalogItemId,
                            rating: newRating
                        })
                        .then((result) => {
                            if (result.success) {
                                console.log(`[ratingsInputDesktop.onChange] Rating submitted successfully for order ${itemData.displayOrderId}`);
                                MessageHandler.showMessage({
                                    message: result.message,
                                    type: 'success'
                                });
                                $item('#ratingsInputDesktop').value = Number(newRating);
                                // Show "Write a Review" button after rating
                                if ($item('#writeReviewButton').type) {
                                    $item('#writeReviewButton').show();
                                }
                                if ($item('#reviewStatusText').type) {
                                    $item('#reviewStatusText').hide();
                                }
                                if ($item('#seeReviewButton').type) {
                                    $item('#seeReviewButton').hide();
                                }
                                // Update repeater item data with new rating
                                const currentData = $w('#ordersRepeater').data;
                                const updatedItem = {
                                    ...itemData,
                                    review: {
                                        ...itemData.review,
                                        rating: newRating
                                    }
                                };
                                const itemIndex = currentData.findIndex(item => item._id === itemData._id);
                                if (itemIndex !== -1) {
                                    currentData[itemIndex] = updatedItem;
                                    $w('#ordersRepeater').data = currentData;
                                }
                            } else {
                                console.error(`[ratingsInputDesktop.onChange] Error submitting rating: ${result.message}`);
                                MessageHandler.showMessage({
                                    message: result.message,
                                    type: 'error'
                                });
                                $item('#ratingsInputDesktop').value = null;
                            }
                        })
                        .catch((error) => {
                            console.error(`[ratingsInputDesktop.onChange] Error submitting rating for order ${itemData.displayOrderId}:`, error);
                            MessageHandler.showMessage({
                                message: "Failed to submit rating. Please try again.",
                                type: 'error'
                            });
                            $item('#ratingsInputDesktop').value = null;
                        });
                });